# 531 #

## 计算机网络分为5层 ##
1. 物理层
2. 数据链路层
3. 网络层：负责根据ip找到目的地址的主机
4. 运输层：通过端口把数据传到目的主机的目的进程，来实现进程与进程之间的通信
5. 应用层




## http的七层协议 ##
socket（套接字）是通信的基石，是支持tcp/ip协议的网络通信的基本操作单元，包含进行网络通信必须的五种信息：
1. 连接使用的协议
2. 本地主机的IP地址
3. 本地进程的协议端口
4. 远地主机的IP地址
5. 远地进程的协议端口

	计算机操作系统为应用程序与TCP协议端口传输数据。
	注释：TCP（传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。（同样也需要三次握手和四次挥手）（传输层的协议）（在ip报文中协议号是6）
		 udp是osi（开放式系统互连）参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务。（在ip报文中协议号是17）

## tcp（三次握手四次挥手） ##
特点：
1. 面向连接：指的是要使用tcp传输数据，必须先建立tcp连接，传输完成后释放链接，就像打电话一样必须先拨号建立一条连接，打完后挂机释放链接
2. 面向字节流：流，指的是流入到进程或从进程流出的字符序列。简单来说，虽然有时候要传输的数据流太大，TCP报文长度有限制，不能一次传输万，要把它分为好几个数据块，但是由于可靠性保证，接收方可以按素和女婿接收数据块然后重新组成分块之前的数据流，所以TCP看起来就像互相传输字节流一样，面向字节流。
3. 全双工通信：即一旦建立了tcp连接，通信双方可以在任何时候哦都能发送数据。
4. 可靠：指的是通过TCP连接传送的数据，无差错，不丢失，不重复，并且按序到达


## 基于UDP协议 ##
	基于udp的应用层协议有TFTP、SNMP与DNS

特点：
1. 无连接的：和TCP要建立连接不同，UDP传输数据不需要建立连接，就像写信，在信封写上收信人名称、地址就可以交给邮局发送了，至于能不能达到，就要看邮局的送信能力和送信过程的困难程度了
2. 不可靠的：因为UDP发出去的数据包发出去就不管了，不管他会不会到达，所以很可能会出现丢包现象，使传输的数据出错。
3. 面向报文：数据报文，就相当于一个数据包，应用层交给UDP多大的数据包，udp就照样发送，不会像tcp那样拆封
4. 没有拥塞控制


## 关于ob缓存 ##

php会把输出的内容放到【程序缓存】中，待程序跑完，把【程序缓存】中的东西全部抛到浏览器中；现在使用ob缓存，开启后，所有的输出都会放到【ob缓存】中，头信息（header）等这些依旧存放到【程序缓存】中，待程序跑完，【ob缓存】中的内容会被放到【程序缓存】内容后面，再送到浏览器。ob_flush()是把【ob缓存】中的内容放到【程序缓存】中，之前只有待程序跑完才会把【ob缓存】内容放到【程序缓存】中，现在用ob_flush()就可以在任意时候送到【程序缓存】中；flush()函数的作用是把【程序缓存】中的数据抛到浏览器中；
总结：ob_flush()把ob缓存中的内容放到程序缓存
flush()是把程序缓存中的内容送到浏览器缓存中



## 什么是程序缓存 ##
- 离线浏览：用户可在应用离线时使用它们
- 速度-以缓存资源加载得更快
- 减少服务器负载：浏览器将只从服务器下载更新过或更改过得资源

	离线存储技术（从可用性和易用性来说，application cache是值得使用的，但是最好是做静态资源的缓存，真正要实现离线应用还得花更多得功夫）
	
- localstorage：应该存储一下非关键性ajax数据
- application cache（5m）
- 传统的离线存储技术为cookie



网络七层协议：
- 物理层
- 数据链路层
- 网络层：IP协议对应网络层
- 传输层：TCP协议对应传输层
- 会话层
- 表示层
- 应用层：HTTP协议

	HTTP协议是基于TCP连接的
	TCP/IP是传输层协议，主要是解决数据如何在网络中传输；
	HTTP协议是应用层协议，主要解决如何包装数据。
	socket是应用层与TCP/IP协议族通信得中间软件抽象层，是他的一组接口。



	物理层，数据链路层和网络层通常被称作媒体层，是网络工程师所研究的对象；
	传输层，会话层，表示层和应用层则被称作主机层，使用户所面向和关心得内容


![](https://i.imgur.com/ca4qlwA.png)



## http ##
超文本传输协议，http协议是建立在TCP协议之上得一种应用。

是短链接，请求结束后，会主动释放链接。

## https ##
是以安全为目标得HTTP通道，是http得安全版。

在http下加入ssl层，https得安全基础是ssl，因此加密得详细内容就需要ssl。

https存在于http和TCP之间。

https存在不同于HTTP得默认端口及一个加密/身份验证层（在HTTP与TCP之间）。HTTP协议以明文方式发送内容，不提供任何方式得数据加密，如果攻击者截取了web浏览器和网站服务器之间得传输报文，就可以直接读懂其中得信息，因此HTTP协议不适合传输一些敏感信息。

## https特点 ##
1. https协议需要到ca申请证书
2. http是超文本传输协议，信息是明文传输，https则是具有安全性得ssl加密传输协议
3. http和https使用的是完全不同得连接方式，用的端口也不一样，http是80，htpps得端口是443
4. http得连接很简单，是无状态的，https协议是由ssl+http协议构建得可进行加密传输、身份认证得网络协议。


## socket连接与http连接的不同 ##
通常情况下socket连接就是tcp连接，因此socket连接一旦建立，通信双方即课开始发送数据内容，知道双方连接断开。但在实际应用中，客户端到服务器之间的通信防火墙默认会关闭长时间处于非活跃状态的连接而导致socket连接断连，因此需要通过轮询高速网络，该链接处于活跃状态。
而http连接使用的是“请求-响应”方式，而且需要客户端向服务器发出请求后，服务器端才能回复数据。



## 关于tcp建立连接 ##
当网络通信采用TCP时，在真正的读写操作之前，server与client之间必须建立一个连接，当读写操作完成后，双方不再需要这个连接时他们可以释放这个连接，连接的建立是需要三次握手的，而释放则需要4次挥手，所以说每个连接的加你都是需要资源消耗和时间消耗的。

## 长连接 ##
	https://www.cnblogs.com/onlysun/p/4520553.html
所谓长连接，指在一个TCP连接上可以连续发送多个数据包，在TCP连接保持期间，如果没有数据包发送，需要双方检测包以维持此连接（不发生rst和四次挥手）

连接->数据传输->保持连接（心跳）->保持连接(心跳)->。。。。。。。->关闭连接（一个TCP连接通道多个读写通道）；

tcp的保活功能：保活功能主要为服务器应用提供，服务器应用希望知道客户主机是否崩溃，从而可以代表酷虎使用资源。如果客户已经消失，使得服务器上保留一个半开放的连接，而服务器又在等待来自客户端的数据，则服务器将应等待客户端的数据，则服务器将应等待客户端的数据，保活功能就是试图在服务器端检测到这种半开放的连接。


## 短链接 ##
短链接是指通信双方有数据交互时，就建立一个tcp连接，数据发送完成后，则断开此TCP连接（管理起来比较简单，存在的连接都是有用的连接，不需要额外的控制手段）；

连接->数据传输->关闭连接；

## 应用场景： ##
- 长连接：多用于操作频繁（读写），点对点的通讯，而且连接数不能太多情况，每个TCP连接都需要三步握手，这需要时间，如果每个操作都是先连接，再操作的话那么处理速度会降低很多，所以每个操作完都不断开，此处离时直接发送数据包就ok了，不用建立TCP连接。例如：数据库连接用长连接，如果端连接频繁的通信会造成socket错误，而且频繁的socket创建也是对资源的浪费。
- 短链接：像web网站的http服务一般都会用短链接（http1.0之支持短链接，1.1keep alive带时间，操作次数限制的长连接），因为长连接对于服务端来说会消耗一定的资源，而像web网站这么频繁的成千上万甚至上亿客户端的连接用短链接会更省一些资源，如果用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那可想而知吧。所以并发量大，但每个用户无需频繁操作情况下需用短链接。

