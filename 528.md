# 528 #
## 什么是tps，什么是qps，区别是什么 ##
- TPS：Transactions Per Second（每秒传输的事物处理个数），即服务器每秒处理的事物数。TPS包括一条消息入和一条消息出，加上一次用户数据库访问（业务tps=caps*每个呼叫平均tps）。
		
	TPS是软件测试结果的测量单位。一个事务是指一个客户机向服务器发送请求然后服务器做出反应的过程。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数。
	一般的，评价系统性能均以每秒钟完成的技术交易的数量来衡量。系统整体处理能力取决于处理能力最低模块的TPS值。


-  QPS：每秒查询率qps是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准，在因特网上，作为域名系统服务器的机器的性能经常每秒查询率来衡量。
	对应fetches/sec，即每秒的响应请求数，也即是最大吞吐能力。




## keepalived的原理使用和配置 ##
Haproxy+keepalived实现高可用负载均衡

两种实现方式：
1. 基于操作系统的软负载均衡
2. 基于第三方应用的软负载实现

	lvs就是基于linux操作系统实现的一种软负载
	HAproxy是开源的并且基于第三应用实现的软负载

HAProxy支持两种主要的代理模式：
1. "tcp"也即4层（大多用于邮件服务器、内部协议通信服务器等）
2. 7层（HTTP）

	在第四层模式下，ha仅在客户端和服务器之间转发双向流量。
	7层模式下，ha会分析协议，并且能通过允许、拒绝、交换、增加、修改或者删除请求（request）或者回应（response）里指定内容来控制协议，这种操作要基于特定规则。



ha的优点：

1. 免费开源，稳定性也是非常好，这个可通过我做的一些小项目可以看出来，单ha也跑得不错，稳定性可以与lvs相媲美；


2. 根据官方文档，作为软件级负载均衡，也是比较惊人的；


3. ha可以作为mysql，邮件或者非web的负载均衡，我们常用于它作为mysql（读）负载均衡；


4. 自带强大的监控服务器状态的页面，实际环境中我们结合nagions进行邮件或短信报警，这个也是我非常喜欢它的原因之一。


5. ha支持虚拟主机。

在做反向代理服务器的负载均衡时，我们通常会使用nginx的均衡配置。其实，ha的负载均衡也是属于这一类的。


## 双机热备 ##
特指基于高可用系统中的两台服务器的热备（或高可用），因两机高可用再国内使用较多，故得名双机热备，双机高可用按工作中的切换方式为主：主-备方式（Active-Standby方式）和双主机方式（Active-Active方式），主-备方式即指的是一台服务器处于某种业务的激活状态（即Active状态），另一台服务器处于该业务的备用状态（即Standby状态）。而双主机方式即指两种业务分别再两台服务器上互为主备状态(即Active-Standby和Standby-Active状态)

## 双机冷备 ##
就是两个服务器，一台用于商用，一台用于实时保持与商用数据库数据同步。这杨一旦商用数据库宕了，就临时把备份数据库机器的ip更改过来用。

缺点：会定时将数据备份至备份服务器或目标硬件，出现故障时不会自动接管，需手动启硬件和服务。



## 四层、七层负载均衡的区别 ##
https://www.cnblogs.com/zhaiyf/p/9051694.html



## haproxy介绍 ##
反向代理服务器，支持双机热备支持虚拟主机，但其配置简单，有非常不错的服务器健康检查功能，当其代理的后端服务器出现故障，haproxy会自动将该服务摘除，故障恢复后再自动将该服务器加入

## keepalived理论工作原理 ##
keepalived可提供vrrp以及health-check功能，可以只用它提供双机浮动的vip（vrrp虚拟路由功能），这样可以简单实现一个双机热备高可用功能。

keepalived是一个类似layer3,4&5交换机制的软件，也就是我们平时说的第三层、第四层和第五层。keepalived的作用是检测web服务器的状态。


## keepalived作用 ##
利用lvs+keepalived基于完整的开源软件的架构可以为你提供一个负载均衡及高可用的服务器。

LVS+keepalived介绍
	LVS是linux virtual server的简写，即linux虚拟服务器，是一个虚拟的服务器集群系统。目前有三种IP负载均衡技术，八种调度技术。

	keepalived在这里主要用作realserver的健康状态记忆
